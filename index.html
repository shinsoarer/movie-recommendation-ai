<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¬ CinemaAI - ä¸–ç•Œæœ€å¤§ç´šã®æ˜ ç”»ãƒ»ã‚¢ãƒ‹ãƒ¡æ¨è–¦ã‚µã‚¤ãƒˆ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
        }
        
        .header h1 {
            font-size: 3em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .api-status {
            background: rgba(255,255,255,0.1);
            color: white;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
            font-size: 14px;
        }
        
        .revenue-banner {
            background: linear-gradient(45deg, #ffd700, #ffb347);
            color: #333;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            font-weight: bold;
        }
        
        .search-section {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .search-form {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr auto;
            gap: 15px;
            align-items: end;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        .form-group label {
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }
        
        .form-group select,
        .form-group input {
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        .form-group select:focus,
        .form-group input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .search-btn {
            padding: 12px 24px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .search-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: white;
            font-size: 18px;
        }
        
        .results-section {
            display: none;
        }
        
        .results-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
        }
        
        .movie-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            transition: transform 0.3s, box-shadow 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        .movie-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .movie-poster {
            width: 80px;
            height: 120px;
            border-radius: 8px;
            object-fit: cover;
            float: left;
            margin-right: 15px;
            margin-bottom: 10px;
        }
        
        .movie-content {
            overflow: hidden;
        }
        
        .movie-title {
            font-size: 1.3em;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
            line-height: 1.3;
        }
        
        .movie-meta {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            color: #666;
            flex-wrap: wrap;
        }
        
        .movie-rating {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .movie-description {
            color: #555;
            line-height: 1.6;
            margin-bottom: 20px;
            clear: both;
            margin-top: 10px;
        }
        
        .affiliate-links {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: auto;
        }
        
        .affiliate-btn {
            padding: 8px 16px;
            border-radius: 20px;
            text-decoration: none;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 5px;
            white-space: nowrap;
        }
        
        .netflix { background: #e50914; color: white; }
        .amazon { background: #ff9900; color: white; }
        .unext { background: #1e1e1e; color: white; }
        .hulu { background: #1ce783; color: white; }
        .disney { background: #113cce; color: white; }
        
        .affiliate-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 3px 10px rgba(0,0,0,0.3);
        }
        
        .ai-recommendation {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        
        .ai-recommendation h3 {
            margin-bottom: 10px;
            font-size: 1.2em;
        }
        
        .source-indicator {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
        }
        
        @media (max-width: 768px) {
            .search-form {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2em;
            }
            
            .results-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¬ CinemaAI</h1>
            <p>ä¸–ç•Œæœ€å¤§ç´šã®æ˜ ç”»ãƒ»ã‚¢ãƒ‹ãƒ¡ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰AIæ¨è–¦</p>
        </div>
        
        <div id="apiStatus" class="api-status">
            ğŸ”„ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šç¢ºèªä¸­...
        </div>
        
        <div class="revenue-banner">
            ğŸ’° ãŠã™ã™ã‚å‹•ç”»é…ä¿¡ã‚µãƒ¼ãƒ“ã‚¹ã§ä»Šã™ãè¦–è´ï¼åˆå›30æ—¥é–“ç„¡æ–™ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³å®Ÿæ–½ä¸­ ğŸ’°
        </div>
        
        <div class="search-section">
            <form class="search-form" id="searchForm">
                <div class="form-group">
                    <label for="contentType">ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¿ã‚¤ãƒ—</label>
                    <select id="contentType">
                        <option value="all">ã™ã¹ã¦</option>
                        <option value="movie">æ˜ ç”»</option>
                        <option value="tv">TVã‚·ãƒªãƒ¼ã‚º</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="genre">ã‚¸ãƒ£ãƒ³ãƒ«</label>
                    <select id="genre">
                        <option value="">ã™ã¹ã¦</option>
                        <option value="28">ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</option>
                        <option value="35">ã‚³ãƒ¡ãƒ‡ã‚£</option>
                        <option value="18">ãƒ‰ãƒ©ãƒ</option>
                        <option value="10749">æ‹æ„›ãƒ»ãƒ­ãƒãƒ³ã‚¹</option>
                        <option value="27">ãƒ›ãƒ©ãƒ¼</option>
                        <option value="878">SF</option>
                        <option value="14">ãƒ•ã‚¡ãƒ³ã‚¿ã‚¸ãƒ¼</option>
                        <option value="16">ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³</option>
                        <option value="53">ã‚¹ãƒªãƒ©ãƒ¼</option>
                        <option value="12">ã‚¢ãƒ‰ãƒ™ãƒ³ãƒãƒ£ãƒ¼</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="year">å…¬é–‹å¹´</label>
                    <select id="year">
                        <option value="">ã™ã¹ã¦</option>
                        <option value="2024">2024</option>
                        <option value="2023">2023</option>
                        <option value="2022">2022</option>
                        <option value="2021">2021</option>
                        <option value="2020">2020</option>
                        <option value="2019">2019</option>
                        <option value="2018">2018</option>
                        <option value="2017">2017</option>
                        <option value="2016">2016</option>
                        <option value="2015">2015</option>
                    </select>
                </div>
                
                <button type="submit" class="search-btn">
                    ğŸ” æ¤œç´¢é–‹å§‹
                </button>
            </form>
        </div>
        
        <div id="loading" class="loading" style="display: none;">
            ğŸ¤– ä¸–ç•Œä¸­ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’æ¤œç´¢ä¸­...
        </div>
        
        <div id="results" class="results-section">
            <div id="aiRecommendation" class="ai-recommendation">
                <h3>ğŸ¤– AIåˆ†æçµæœ</h3>
                <p id="aiComment">æ¡ä»¶ã«æœ€é©ãªä½œå“ã‚’ä¸–ç•Œä¸­ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰å³é¸ã—ã¾ã—ãŸï¼</p>
            </div>
            
            <div id="resultsGrid" class="results-grid">
                <!-- æ¤œç´¢çµæœãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã‚‹ -->
            </div>
        </div>
    </div>

    <script>
        // â­ TMDB APIè¨­å®š - ã“ã“ã«ã‚ãªãŸã®APIã‚­ãƒ¼ã‚’è¨­å®šã—ã¦ãã ã•ã„
        const TMDB_API_KEY = 'aecb5cb2f7f354ca3364a60b905bb823'; // â† ã“ã“ã‚’å®Ÿéš›ã®APIã‚­ãƒ¼ã«å¤‰æ›´
        const TMDB_BASE_URL = 'https://api.themoviedb.org/3';
        const IMAGE_BASE_URL = 'https://image.tmdb.org/t/p/w300';
        
        // ã‚¢ãƒ•ã‚£ãƒªã‚¨ã‚¤ãƒˆè¨­å®š
        const affiliateConfig = {
            amazon: {
                name: "Amazon Prime",
                icon: "ğŸ“º",
                baseUrl: "https://www.amazon.co.jp/s?k=",
                affiliate: "&tag=YOUR_AMAZON_ASSOCIATE_ID" // â† ã‚ãªãŸã®Amazonã‚¢ã‚½ã‚·ã‚¨ã‚¤ãƒˆIDã«å¤‰æ›´
            },
            netflix: {
                name: "Netflix",
                icon: "ğŸ…½",
                baseUrl: "https://www.netflix.com/search?q=",
                affiliate: ""
            },
            unext: {
                name: "U-NEXT",
                icon: "ğŸ¬",
                baseUrl: "https://video.unext.jp/search?query=",
                affiliate: ""
            },
            hulu: {
                name: "Hulu",
                icon: "ğŸŸ¢",
                baseUrl: "https://www.hulu.jp/search?q=",
                affiliate: ""
            },
            disney: {
                name: "Disney+",
                icon: "ğŸ°",
                baseUrl: "https://www.disneyplus.com/search?q=",
                affiliate: ""
            }
        };

        // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ç”¨ã®äººæ°—ä½œå“ãƒ‡ãƒ¼ã‚¿
        const fallbackMovies = [
            {
                title: "é¬¼æ»…ã®åˆƒ ç„¡é™åˆ—è»Šç·¨",
                year: "2020",
                rating: "9.0",
                description: "ç¤¾ä¼šç¾è±¡ã‚’å·»ãèµ·ã“ã—ãŸå¤§ãƒ’ãƒƒãƒˆã‚¢ãƒ‹ãƒ¡æ˜ ç”»ã€‚ç¾ã—ã„ä½œç”»ã¨æ„Ÿå‹•çš„ãªã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã§å¤šãã®äººãŒæ¶™ã—ãŸã€‚",
                source: "Featured"
            },
            {
                title: "ãƒˆãƒƒãƒ—ã‚¬ãƒ³ ãƒãƒ¼ãƒ´ã‚§ãƒªãƒƒã‚¯",
                year: "2022",
                rating: "8.3",
                description: "ãƒˆãƒ ãƒ»ã‚¯ãƒ«ãƒ¼ã‚ºãŒå¸°ã£ã¦ããŸï¼èˆªç©ºã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã®æ±ºå®šç‰ˆã€‚æ¯ã‚’ã®ã‚€ç©ºä¸­æˆ¦ã¨æ„Ÿå‹•ã®ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã€‚",
                source: "Featured"
            },
            {
                title: "ã™ãšã‚ã®æˆ¸ç· ã¾ã‚Š",
                year: "2022",
                rating: "8.0",
                description: "æ–°æµ·èª ç›£ç£æœ€æ–°ä½œã€‚ç½ã„ã®æ‰‰ã‚’é–‰ã˜ã‚‹å°‘å¥³ã®å†’é™ºã‚’æã„ãŸæ„Ÿå‹•ã®ãƒ­ãƒ¼ãƒ‰ãƒ ãƒ¼ãƒ“ãƒ¼ã€‚",
                source: "Featured"
            },
            {
                title: "ã‚¢ãƒ™ãƒ³ã‚¸ãƒ£ãƒ¼ã‚º/ã‚¨ãƒ³ãƒ‰ã‚²ãƒ¼ãƒ ",
                year: "2019",
                rating: "8.4",
                description: "ãƒãƒ¼ãƒ™ãƒ«ãƒ»ã‚·ãƒãƒãƒ†ã‚£ãƒƒã‚¯ãƒ»ãƒ¦ãƒ‹ãƒãƒ¼ã‚¹ã®å£®å¤§ãªå®Œçµç·¨ã€‚å…¨ãƒ’ãƒ¼ãƒ­ãƒ¼ãŒçµé›†ã™ã‚‹å²ä¸Šæœ€å¤§ã®ãƒãƒˆãƒ«ã€‚",
                source: "Featured"
            },
            {
                title: "å›ã®åã¯ã€‚",
                year: "2016",
                rating: "8.2",
                description: "æ–°æµ·èª ç›£ç£ã«ã‚ˆã‚‹æ‹æ„›ãƒ•ã‚¡ãƒ³ã‚¿ã‚¸ãƒ¼ã®åä½œã€‚ç¾ã—ã„æ˜ åƒç¾ã¨å¿ƒã«éŸ¿ãéŸ³æ¥½ã€ãã—ã¦åˆ‡ãªã„æ‹æ„›ã‚¹ãƒˆãƒ¼ãƒªãƒ¼ã€‚",
                source: "Featured"
            },
            {
                title: "åƒã¨åƒå°‹ã®ç¥éš ã—",
                year: "2001",
                rating: "9.3",
                description: "å®®å´é§¿ç›£ç£ã«ã‚ˆã‚‹ã‚¹ã‚¿ã‚¸ã‚ªã‚¸ãƒ–ãƒªã®ä»£è¡¨ä½œã€‚ç¥ã€…ã®ä¸–ç•Œã«è¿·ã„è¾¼ã‚“ã å°‘å¥³ã®æˆé•·ã‚’æãä¸æœ½ã®åä½œã€‚",
                source: "Featured"
            }
        ];

        let apiWorking = false;

        // APIæ¥ç¶šãƒ†ã‚¹ãƒˆ
        async function testAPI() {
            try {
                if (TMDB_API_KEY === 'YOUR_TMDB_API_KEY_HERE') {
                    document.getElementById('apiStatus').innerHTML = 
                        'âš ï¸ TMDB APIã‚­ãƒ¼ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ï¼ˆãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã§å‹•ä½œä¸­ï¼‰';
                    return false;
                }

                const response = await fetch(`${TMDB_BASE_URL}/movie/popular?api_key=${TMDB_API_KEY}&language=ja-JP&page=1`);
                if (response.ok) {
                    apiWorking = true;
                    document.getElementById('apiStatus').innerHTML = 
                        'âœ… TMDB APIæ¥ç¶šæˆåŠŸï¼50ä¸‡æœ¬ä»¥ä¸Šã®æ˜ ç”»ãƒ»TVã‚·ãƒªãƒ¼ã‚ºã‹ã‚‰æ¤œç´¢å¯èƒ½';
                    return true;
                } else {
                    throw new Error('API response not ok');
                }
            } catch (error) {
                document.getElementById('apiStatus').innerHTML = 
                    'âš ï¸ TMDB APIæ¥ç¶šå¤±æ•—ï¼ˆãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã§å‹•ä½œä¸­ï¼‰';
                return false;
            }
        }

        // TMDB APIã§æ¤œç´¢
        async function searchTMDB(contentType, genre, year) {
            if (!apiWorking) return [];

            const results = [];
            
            try {
                if (contentType === 'movie' || contentType === 'all') {
                    const movieUrl = buildTMDBUrl('discover/movie', genre, year);
                    const movieData = await fetch(movieUrl);
                    if (movieData.ok) {
                        const data = await movieData.json();
                        results.push(...data.results.map(formatTMDBMovie));
                    }
                }
                
                if (contentType === 'tv' || contentType === 'all') {
                    const tvUrl = buildTMDBUrl('discover/tv', genre, year);
                    const tvData = await fetch(tvUrl);
                    if (tvData.ok) {
                        const data = await tvData.json();
                        results.push(...data.results.map(formatTMDBTV));
                    }
                }
            } catch (error) {
                console.log('TMDBæ¤œç´¢ã‚¨ãƒ©ãƒ¼:', error);
            }
            
            return results;
        }

        function buildTMDBUrl(endpoint, genre, year) {
            const url = new URL(`${TMDB_BASE_URL}/${endpoint}`);
            url.searchParams.append('api_key', TMDB_API_KEY);
            url.searchParams.append('language', 'ja-JP');
            url.searchParams.append('sort_by', 'popularity.desc');
            url.searchParams.append('page', '1');
            
            if (genre) {
                url.searchParams.append('with_genres', genre);
            }
            
            if (year) {
                url.searchParams.append('year', year);
            }
            
            return url.toString();
        }

        function formatTMDBMovie(movie) {
            return {
                title: movie.title || movie.original_title,
                year: movie.release_date ? movie.release_date.substring(0, 4) : 'N/A',
                rating: movie.vote_average ? movie.vote_average.toFixed(1) : 'N/A',
                description: movie.overview || 'èª¬æ˜ãŒåˆ©ç”¨ã§ãã¾ã›ã‚“',
                poster: movie.poster_path ? `${IMAGE_BASE_URL}${movie.poster_path}` : null,
                source: 'TMDB'
            };
        }

        function formatTMDBTV(tv) {
            return {
                title: tv.name || tv.original_name,
                year: tv.first_air_date ? tv.first_air_date.substring(0, 4) : 'N/A',
                rating: tv.vote_average ? tv.vote_average.toFixed(1) : 'N/A',
                description: tv.overview || 'èª¬æ˜ãŒåˆ©ç”¨ã§ãã¾ã›ã‚“',
                poster: tv.poster_path ? `${IMAGE_BASE_URL}${tv.poster_path}` : null,
                source: 'TMDB'
            };
        }

        // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
        function getFallbackResults(contentType, genre, year) {
            let results = [...fallbackMovies];
            
            // å¹´ä»£ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
            if (year) {
                results = results.filter(item => item.year === year);
            }
            
            // ãƒ©ãƒ³ãƒ€ãƒ ã«ä¸¦ã³æ›¿ãˆ
            for (let i = results.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [results[i], results[j]] = [results[j], results[i]];
            }
            
            return results;
        }

        // æ¤œç´¢å®Ÿè¡Œ
        document.getElementById('searchForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const contentType = document.getElementById('contentType').value;
            const genre = document.getElementById('genre').value;
            const year = document.getElementById('year').value;
            
            document.getElementById('loading').style.display = 'block';
            document.getElementById('results').style.display = 'none';
            
            try {
                let results = [];
                
                // TMDB APIã‹ã‚‰æ¤œç´¢
                if (apiWorking) {
                    results = await searchTMDB(contentType, genre, year);
                }
                
                // çµæœãŒå°‘ãªã„å ´åˆã¯ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ 
                if (results.length < 6) {
                    const fallbackResults = getFallbackResults(contentType, genre, year);
                    results.push(...fallbackResults.slice(0, 6 - results.length));
                }
                
                displayResults(results, contentType, genre, year);
                
            } catch (error) {
                console.error('æ¤œç´¢ã‚¨ãƒ©ãƒ¼:', error);
                const fallbackResults = getFallbackResults(contentType, genre, year);
                displayResults(fallbackResults, contentType, genre, year);
            } finally {
                document.getElementById('loading').style.display = 'none';
                document.getElementById('results').style.display = 'block';
            }
        });

        function displayResults(results, contentType, genre, year) {
            const aiComment = generateAIComment(results.length, contentType, genre, year);
            document.getElementById('aiComment').textContent = aiComment;
            
            const resultsGrid = document.getElementById('resultsGrid');
            resultsGrid.innerHTML = '';
            
            if (results.length === 0) {
                resultsGrid.innerHTML = '<div style="grid-column: 1/-1; text-align: center; padding: 40px; color: #666;"><h3>è©²å½“ã™ã‚‹ä½œå“ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ</h3><p>åˆ¥ã®æ¡ä»¶ã§æ¤œç´¢ã—ã¦ã¿ã¦ãã ã•ã„</p></div>';
                return;
            }
            
            results.forEach(item => {
                const movieCard = createMovieCard(item);
                resultsGrid.appendChild(movieCard);
            });
        }

        function generateAIComment(count, contentType, genre, year) {
            const typeText = {
                'all': 'ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ†ã‚¤ãƒ¡ãƒ³ãƒˆä½œå“',
                'movie': 'æ˜ ç”»',
                'tv': 'TVã‚·ãƒªãƒ¼ã‚º'
            }[contentType] || 'ã‚³ãƒ³ãƒ†ãƒ³ãƒ„';
            
            const sourceText = apiWorking ? 'ä¸–ç•Œä¸­ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹' : 'å³é¸ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹';
            
            return `${count}æœ¬ã®${typeText}ã‚’${sourceText}ã‹ã‚‰å³é¸ã—ã¾ã—ãŸï¼ã©ã‚Œã‚‚é«˜è©•ä¾¡ã®ä½œå“ã°ã‹ã‚Šã§ã™ã€‚`;
        }

        function createMovieCard(item) {
            const card = document.createElement('div');
            card.className = 'movie-card';
            
            const posterImg = item.poster ? 
                `<img src="${item.poster}" alt="${item.title}" class="movie-poster" onerror="this.style.display='none'">` : '';
            
            const affiliateLinks = createAffiliateLinks(item.title);
            
            card.innerHTML = `
                <div class="source-indicator">${item.source}</div>
                ${posterImg}
                <div class="movie-content">
                    <div class="movie-title">${item.title}</div>
                    <div class="movie-meta">
                        <span>${item.year}</span>
                        <div class="movie-rating">
                            <span>â­</span>
                            <span>${item.rating}/10</span>
                        </div>
                    </div>
                    <div class="movie-description">${item.description}</div>
                    <div class="affiliate-links">
                        ${affiliateLinks}
                    </div>
                </div>
            `;
            
            return card;
        }

        function createAffiliateLinks(title) {
            const searchQuery = encodeURIComponent(title);
            const links = [];
            
            Object.entries(affiliateConfig).forEach(([platform, config]) => {
                const url = config.baseUrl + searchQuery + config.affiliate;
                
                links.push(`
                    <a href="${url}" 
                       class="affiliate-btn ${platform}" 
                       target="_blank" 
                       rel="noopener nofollow">
                        ${config.icon} ${config.name}
                    </a>
                `);
            });
            
            return links.join('');
        }

        // åˆæœŸåŒ–
        window.addEventListener('load', async function() {
            await testAPI();
            
            setTimeout(async () => {
                const initialResults = apiWorking ? 
                    await searchTMDB('all', '', '') :
                    getFallbackResults('all', '', '');
                
                displayResults(initialResults.slice(0, 6), 'all', '', '');
                document.getElementById('results').style.display = 'block';
            }, 1000);
        });
    </script>
</body>
</html>
